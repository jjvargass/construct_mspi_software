kind: pipeline
name: qa_devops

steps:
- name: check_readme
  image: python:2.7
  commands:
  - python qa/check_readme.py
  when:
    branch:
    - dev
    - test
    - master

- name: check_branch
  image: python:2.7
  commands:
  - pip install gitpython
  - python qa/check_branch.py
  when:
    branch:
    - dev
    - test
    - master

- name: slack_notify
  image: plugins/slack
  settings:
    webhook:
      from_secret: webhook_and
    channel: ci-develop
    link_names: true
    format: html
    template: >
      {{#success build.status}}
        {{repo.name}}/{{build.branch}} build {{build.number}} SUCCEEDED by:@{{build.author}}
      {{else}}
        {{repo.name}}/{{build.branch}} build {{build.number}} FAILED by:@{{build.author}}
      {{/success}}

---

kind: pipeline
name: deploy_client

steps:
- name: deploy
  image: alpine
  commands:
  - echo hello world
  when:
    branch:
    - dev
    - test
    - master